# Frida-Analykit

[![GitHub Stars](https://img.shields.io/github/stars/zsa233/frida-analykit)](https://github.com/zsa233/frida-analykit/stargazers)
[![License](https://img.shields.io/github/license/zsa233/frida-analykit)](LICENSE)

🌍 Language: [中文](README.md) | English

## Introduction

**⚠ Currently only supports arm64**

> Frida analysis toolkit for quickly building basic utility methods during the injection and debugging process, allowing you to focus on solving real-world problems.

1. Use `python` to proxy all inputs and outputs from the `js` layer via RPC
    - Use `JsHandle` to proxy JS variables, indirectly using a `python-REPL` to simulate a `js-REPL` for debugging.
    - Resolves overlapping console input/output between native JS log outputs and `js-REPL`.
    - Solves the tedious manual file pulling during log/data output for archiving and analysis.

2. Use `frida-compile` to support modular development

3. Tool methods are designed for general scenarios rather than specific ones

## Toolkits

| Name      | Available | Notes                                 |
|-----------|:---------:|---------------------------------------|
| nettools  | √         | Packet capture assistance             |
| elftools  | √         | .so file parsing; symbol-attach (TODO)|
| jnitools  | TODO      | JNI helper; jni_java (TODO)           |
| dextools  | TODO      | Dex helper                            |

## Usage

**It is recommended to `fork` this project for custom modifications or use `git clone` directly.**

The following steps will build a directory structure as follows:
```md
myproj
├── frida-analykit/
│   ├── agent/
│   ├── script/
│   ├── templates/
│   ├── gen.py
│   ├── main.py
│   └── ...
│
├── config.yml
├── index.ts
├── ptpython_spawn.sh
├── package.json
└── ...
```

1. Clone the scripts
```sh
# (For single project) Directly git clone in working directory:
# (For multiple projects) Use a symlink to link to current directory
# Working path: myproj
git clone https://github.com/ZSA233/frida-analykit.git
```

2. Generate working environment

```sh
# Before this, choose your desired global or pyenv environment to install dependencies
# pip install -r requirements.txt

# Generate environment files (e.g., index.ts, config.yml, ptpython_spaw.sh etc.)
python frida-analykit/gen.py dev
```

3. Configure config.yml
> Configuration file: `config.yml`

```yml
# Target package name (required)
app: 
# Agent script automatically generated by frida-compile
jsfile: _agent.js

server:
  # Path to frida-server binary on target device
  servername: /data/local/tmp/frida-server
  # ADB forward mapped to host address and port
  host: 127.0.0.1:6666
  # Device ID required for multiple devices (check via adb devices)
  device: aaaaaaaa

agent:
  # Data from js send calls not registered with a handler will be saved here
  datadir: ./data/
  stdout: ./logs/outerr.log
  stderr: ./logs/outerr.log

script:
  nettools:
    ssl_log_secret: ./data/nettools/sslkey/
```

4. Start frida-compile file watcher
```sh
# Use the following command to watch index.ts for changes and compile _agent.js in real-time
npm run watch
```

5. Start frida-server service
```sh
python frida-analykit/main.py bootup-server
```

6. Run the script

```sh
# Options:
# 1. Use REPL to spawn/attach inject
./ptpython_spawn.sh
./ptpython_attach.sh

# 2. Run scripts directly
python frida-analykit/main.py spawn
```

## Platform

| Platform | Supported |
|:--------:|:---------:|
| Windows  | Supported via WSL |
| Linux    | √ |
| macOS    | √ |

## Examples

[android-reverse-examples](https://github.com/ZSA233/android-reverse-examples)
